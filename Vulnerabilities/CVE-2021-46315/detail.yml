cve-id: CVE-2021-46315

info:
  name: D-Link DIR-846 通过 SetWizardConfig.php 绕过外壳元字符实现远程命令执行的漏洞
  description: D-Link路由器DIR-846 DIR846A1_FW100A43.bin和DIR 846 enFW 100 A53 DLA-Retail.bin中的HNAP
    1/control/SetWizardConfig.php中存在远程命令执行（RCE）漏洞。Malicoius用户可以利用此漏洞在ssid 0或ssid 
    1参数的shell元字符中使用“\“或反引号，从而导致执行任意命令。由于CVE-2019-17510漏洞尚未修补和改进www/hnap1/control/setwizards.php，还可以使用换行符和反引号来绕过。
  score: 9.8
  severity: critical
  tags: [command-injection, rce, tp-link]

environments:
- name: BM-2024-00009
  payload: BM-2024-00009-payload.seed



matchers:
- type: service_behavior
  expected: crash
