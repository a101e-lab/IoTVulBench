cve-id: CVE-2018-19990
info:
  name: dir823g , dir-822, dir-860l, dir-868l, dir-880l, dir-890l command injection
  description: In the /HNAP1/SetWiFiVerifyAlpha message, the WPSPIN parameter is vulnerable,
    and the vulnerability affects D-Link DIR-822 B1 202KRb06 devices. In the SetWiFiVerifyAlpha.php
    source code, the WPSPIN parameter is saved in the $rphyinf1."/media/wps/enrollee/pin"
    and $rphyinf2."/media/wps/enrollee/pin" and $rphyinf3."/media/wps/enrollee/pin"
    internal configuration memory without any regex checking. And in the do_wps function
    of the wps.php source code, the data in $rphyinf3."/media/wps/enrollee/pin" is
    used with the wpatalk command without any regex checking. A vulnerable /HNAP1/SetWiFiVerifyAlpha
    XML message could have shell metacharacters in the WPSPIN element such as the
    `telnetd` string.

  score: 9.8
  severity: critical
  tags: [d-link, router, dos, unauthenticated, command-injection]
environments:
- name: BM-2024-00083
  payload: BM-2024-00083-payload.seed

matchers:
- type: service_behavior
  expected: crash
