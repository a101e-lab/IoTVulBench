cve-id: CVE-2018-19986
info:
  name: dir823g and dir868l command injection
  description: In the /HNAP1/SetRouterSettings message, the RemotePort parameter is
    vulnerable, and the vulnerability affects D-Link DIR-818LW Rev.A 2.05.B03 and
    DIR-822 B1 202KRb06 devices. In the SetRouterSettings.php source code, the RemotePort
    parameter is saved in the $path_inf_wan1."/web" internal configuration memory
    without any regex checking. And in the IPTWAN_build_command function of the iptwan.php
    source code, the data in $path_inf_wan1."/web" is used with the iptables command
    without any regex checking. A vulnerable /HNAP1/SetRouterSettings XML message
    could have shell metacharacters in the RemotePort element such as the `telnetd`
    string.

  score: 9.8
  severity: critical
  tags: [d-link, router, dos, unauthenticated, command-injection]
environments:
- name: BM-2024-00083
  payload: BM-2024-00083-payload.seed

matchers:
- type: service_behavior
  expected: crash
